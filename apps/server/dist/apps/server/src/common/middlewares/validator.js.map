{
  "version": 3,
  "sources": ["../../../../../../src/common/middlewares/validator.ts"],
  "sourcesContent": ["import { Request, Response, NextFunction } from 'express';\r\nimport { ZodType, ZodError, infer as zInfer } from 'zod';\r\nimport { errorHandler } from './responseHandler';\r\n\r\n// \uD83D\uDD39 Generic validator factory\r\nfunction validateRequestPart<T extends ZodType<any, any>>(\r\n  schema: T,\r\n  part: 'body' | 'params' | 'query'\r\n) {\r\n  return (\r\n    req: Request,\r\n    res: Response,\r\n    next: NextFunction\r\n  ): void => {\r\n    const result = schema.safeParse(req[part]);\r\n\r\n    if (!result.success) {\r\n      const formattedErrors = formatZodErrors(result.error);\r\n      errorHandler(res, 'Validation failed', formattedErrors, 400);\r\n      return;\r\n    }\r\n\r\n    // Apply parsed + typed data\r\n    (req as any)[part] = result.data;\r\n    next();\r\n  };\r\n}\r\n\r\n// \uD83D\uDD39 Error formatter (production-friendly)\r\nfunction formatZodErrors(error: ZodError) {\r\n  return error.issues.map(issue => ({\r\n    field: issue.path.join('.'),\r\n    message: issue.message,\r\n  }));\r\n}\r\n\r\n// \uD83D\uDD39 Convenience wrappers (typed)\r\nexport function validateBody<T extends ZodType<any, any>>(schema: T) {\r\n  return validateRequestPart(schema, 'body') as (\r\n    req: Request<unknown, unknown, zInfer<T>>,\r\n    res: Response,\r\n    next: NextFunction\r\n  ) => void;\r\n}\r\n\r\nexport function validateParams<T extends ZodType<any, any>>(schema: T) {\r\n  return validateRequestPart(schema, 'params') as (\r\n    req: Request<zInfer<T>>,\r\n    res: Response,\r\n    next: NextFunction\r\n  ) => void;\r\n}\r\n\r\nexport function validateQuery<T extends ZodType<any, any>>(schema: T) {\r\n  return validateRequestPart(schema, 'query') as (\r\n    req: Request<unknown, unknown, unknown, zInfer<T>>,\r\n    res: Response,\r\n    next: NextFunction\r\n  ) => void;\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,6BAA6B;AAG7B,SAAS,oBACP,QACA,MACA;AACA,SAAO,CACL,KACA,KACA,SACS;AACT,UAAM,SAAS,OAAO,UAAU,IAAI,IAAI,CAAC;AAEzC,QAAI,CAAC,OAAO,SAAS;AACnB,YAAM,kBAAkB,gBAAgB,OAAO,KAAK;AACpD,+CAAa,KAAK,qBAAqB,iBAAiB,GAAG;AAC3D;AAAA,IACF;AAGA,IAAC,IAAY,IAAI,IAAI,OAAO;AAC5B,SAAK;AAAA,EACP;AACF;AAGA,SAAS,gBAAgB,OAAiB;AACxC,SAAO,MAAM,OAAO,IAAI,YAAU;AAAA,IAChC,OAAO,MAAM,KAAK,KAAK,GAAG;AAAA,IAC1B,SAAS,MAAM;AAAA,EACjB,EAAE;AACJ;AAGO,SAAS,aAA0C,QAAW;AACnE,SAAO,oBAAoB,QAAQ,MAAM;AAK3C;AAEO,SAAS,eAA4C,QAAW;AACrE,SAAO,oBAAoB,QAAQ,QAAQ;AAK7C;AAEO,SAAS,cAA2C,QAAW;AACpE,SAAO,oBAAoB,QAAQ,OAAO;AAK5C;",
  "names": []
}
