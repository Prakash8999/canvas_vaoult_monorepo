{
  "version": 3,
  "sources": ["../../../../../../src/modules/quick-capture/qc.controller.ts"],
  "sourcesContent": ["import { Request, Response } from \"express\";\r\nimport { errorHandler, successHandler } from \"../../common/middlewares/responseHandler\";\r\nimport { parseError } from \"../../common/utils/error.parser\";\r\nimport * as qcService from \"./qc.service\";\r\nimport { NoteQueryAttributes } from \"../notes/notes.model\";\r\n\r\n// CRUD Operations\r\n\r\nexport const createQuickCapture = async (req: Request, res: Response) => {\r\n    try {\r\n        if (!req.user || !req.user.userId) {\r\n            errorHandler(res, \"Unauthorized\", {}, 401);\r\n            return;\r\n        }\r\n        const userId = req.user.userId;\r\n        const note = await qcService.createQuickCaptureService(req.body, userId);\r\n        successHandler(res, \"Quick capture created successfully\", note, 201);\r\n    } catch (error) {\r\n        console.error(\"Error creating quick capture:\", error);\r\n        const errorParser = parseError(error);\r\n        errorHandler(res, \"Failed to create quick capture\", errorParser.message, errorParser.statusCode);\r\n    }\r\n};\r\n\r\nexport const getAllQuickCaptures = async (req: Request, res: Response) => {\r\n    try {\r\n        const userId = req.user.userId;\r\n\r\n        // Query params are already validated and typed by validateQuery middleware\r\n        const filters: NoteQueryAttributes = {\r\n            ...req.query,\r\n        };\r\n\r\n        const result = await qcService.getAllQuickCapturesService(userId, filters);\r\n\r\n        const responseData = {\r\n            quickCaptures: result.data,\r\n            pagination: {\r\n                total: result.meta.total_count,\r\n                page: result.meta.page,\r\n                limit: result.meta.limit,\r\n                totalPages: result.meta.total_pages,\r\n                hasMore: result.meta.page < result.meta.total_pages,\r\n            }\r\n        };\r\n\r\n        successHandler(res, \"Quick captures fetched successfully\", responseData, 200);\r\n        return;\r\n    } catch (error) {\r\n        console.log(\"Error fetching quick captures:\", error);\r\n        const errorParser = parseError(error);\r\n        errorHandler(res, \"Failed to fetch quick captures\", errorParser.message, errorParser.statusCode);\r\n        return\r\n    }\r\n};\r\n\r\nexport const getQuickCapture = async (req: Request, res: Response) => {\r\n    try {\r\n        const userId = req.user.userId;\r\n        // Params are validated by validateParams middleware\r\n        const { id } = req.params;\r\n\r\n        const note = await qcService.getQuickCaptureByIdService(Number(id), userId);\r\n\r\n        if (!note) {\r\n            errorHandler(res, \"Quick capture not found\", {}, 404);\r\n            return\r\n        }\r\n\r\n        successHandler(res, \"Quick capture fetched successfully\", note, 200);\r\n        return;\r\n    } catch (error) {\r\n        const errorParser = parseError(error);\r\n        errorHandler(res, \"Failed to fetch quick capture\", errorParser.message, errorParser.statusCode);\r\n        return;\r\n    }\r\n};\r\n\r\nexport const updateQuickCapture = async (req: Request, res: Response) => {\r\n    try {\r\n        const userId = req.user.userId;\r\n        const { id } = req.params;\r\n\r\n        console.log(\"Updating quick capture body:\", req.body);\r\n        const note = await qcService.updateQuickCaptureService(Number(id), req.body, userId);\r\n\r\n        if (!note) {\r\n            errorHandler(res, \"Quick capture not found\", {}, 404);\r\n            return;\r\n        }\r\n\r\n        successHandler(res, \"Quick capture updated successfully\", note, 200);\r\n        return;\r\n    } catch (error) {\r\n        console.error(\"Error updating quick capture:\", error);\r\n        const errorParser = parseError(error);\r\n        errorHandler(res, \"Failed to update quick capture\", errorParser.message, errorParser.statusCode);\r\n        return;\r\n    }\r\n};\r\n\r\nexport const deleteQuickCapture = async (req: Request, res: Response) => {\r\n    try {\r\n        const userId = req.user.userId;\r\n        const { id } = req.params;\r\n\r\n        const deleted = await qcService.deleteQuickCaptureService(Number(id), userId);\r\n\r\n        if (!deleted) {\r\n            errorHandler(res, \"Quick capture not found\", {}, 404);\r\n            return;\r\n        }\r\n\r\n        successHandler(res, \"Quick capture deleted successfully\", { deletedId: Number(id) }, 200);\r\n        return;\r\n    } catch (error) {\r\n        const errorParser = parseError(error);\r\n        errorHandler(res, \"Failed to delete quick capture\", errorParser.message, errorParser.statusCode);\r\n        return;\r\n    }\r\n};\r\n"],
  "mappings": "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",
  "names": []
}
