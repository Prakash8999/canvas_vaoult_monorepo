{
  "version": 3,
  "sources": ["../../../../../../src/modules/ai/ai.types.ts"],
  "sourcesContent": ["import { z } from 'zod';\r\n\r\n// -----------------------------\r\n// \uD83E\uDDE9 AI Provider Types\r\n// -----------------------------\r\n\r\n/**\r\n * Supported AI providers\r\n */\r\nexport type AIProvider = 'gemini' | 'perplexity';\r\n\r\n/**\r\n * Supported models per provider\r\n */\r\nexport const PROVIDER_MODELS = {\r\n    gemini: ['gemini-2.0-flash-exp', 'gemini-exp-1206', 'gemini-3-pro-preview'] as const,\r\n    perplexity: ['sonar', 'sonar-pro'] as const,\r\n} as const;\r\n\r\nexport type GeminiModel = typeof PROVIDER_MODELS.gemini[number];\r\nexport type PerplexityModel = typeof PROVIDER_MODELS.perplexity[number];\r\nexport type AIModel = GeminiModel | PerplexityModel;\r\n\r\n/**\r\n * Input/Output constraints\r\n */\r\nexport const AI_CONSTRAINTS = {\r\n    MAX_INPUT_LENGTH: 300, // Maximum characters allowed in input\r\n    MAX_TOKEN_ESTIMATE: 200, // Approximate token limit\r\n    CREDIT_COST_PER_REQUEST: 1, // Credits consumed per request\r\n    DEFAULT_USER_CREDITS: 10, // Starting credits for new users\r\n} as const;\r\n\r\n// -----------------------------\r\n// \uD83E\uDDE9 Request/Response Schemas\r\n// -----------------------------\r\n\r\n/**\r\n * AI Request Schema\r\n */\r\nexport const AIRequestSchema = z.object({\r\n    provider: z.enum(['gemini', 'perplexity']),\r\n    model: z.string().min(1),\r\n    input: z.string()\r\n        .min(1, 'Input cannot be empty')\r\n        .max(AI_CONSTRAINTS.MAX_INPUT_LENGTH, `Input must not exceed ${AI_CONSTRAINTS.MAX_INPUT_LENGTH} characters`),\r\n    options: z.object({\r\n        temperature: z.number().min(0).max(2).optional(),\r\n        maxTokens: z.number().int().positive().optional(),\r\n    }).optional(),\r\n});\r\n\r\nexport type AIRequest = z.infer<typeof AIRequestSchema>;\r\n\r\n/**\r\n * Normalized AI Response\r\n */\r\nexport interface AIResponse {\r\n    content: string;\r\n    provider: AIProvider;\r\n    model: string;\r\n    tokensUsed?: number;\r\n    metadata?: Record<string, unknown>;\r\n}\r\n\r\n/**\r\n * AI Service Response (includes credits)\r\n */\r\nexport interface AIServiceResponse extends AIResponse {\r\n    remainingCredits: number;\r\n    creditsUsed: number;\r\n    usingCustomKey: boolean; // Flag to indicate if BYOK is being used\r\n}\r\n\r\n// -----------------------------\r\n// \uD83E\uDDE9 AI Provider Interface\r\n// -----------------------------\r\n\r\n/**\r\n * Common interface that all AI providers must implement\r\n * This ensures provider-agnostic architecture\r\n */\r\nexport interface IAIProvider {\r\n    /**\r\n     * Provider identifier\r\n     */\r\n    readonly name: AIProvider;\r\n\r\n    /**\r\n     * Generate AI response\r\n     * @param input - User input text\r\n     * @param model - Model to use\r\n     * @param apiKey - API key for the provider\r\n     * @param options - Optional parameters\r\n     * @returns Normalized AI response\r\n     */\r\n    generateResponse(\r\n        input: string,\r\n        model: string,\r\n        apiKey: string,\r\n        options?: {\r\n            temperature?: number;\r\n            maxTokens?: number;\r\n        }\r\n    ): Promise<AIResponse>;\r\n\r\n    /**\r\n     * Validate if the model is supported by this provider\r\n     * @param model - Model name to validate\r\n     */\r\n    isModelSupported(model: string): boolean;\r\n}\r\n\r\n// -----------------------------\r\n// \uD83E\uDDE9 Error Types\r\n// -----------------------------\r\n\r\nexport class AIProviderError extends Error {\r\n    constructor(\r\n        message: string,\r\n        public provider: AIProvider,\r\n        public statusCode: number = 500\r\n    ) {\r\n        super(message);\r\n        this.name = 'AIProviderError';\r\n    }\r\n}\r\n\r\nexport class InsufficientCreditsError extends Error {\r\n    constructor(\r\n        public required: number,\r\n        public available: number\r\n    ) {\r\n        super(`Insufficient AI credits. Required: ${required}, Available: ${available}`);\r\n        this.name = 'InsufficientCreditsError';\r\n    }\r\n}\r\n\r\nexport class InvalidInputError extends Error {\r\n    constructor(message: string) {\r\n        super(message);\r\n        this.name = 'InvalidInputError';\r\n    }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAkB;AAcX,MAAM,kBAAkB;AAAA,EAC3B,QAAQ,CAAC,wBAAwB,mBAAmB,sBAAsB;AAAA,EAC1E,YAAY,CAAC,SAAS,WAAW;AACrC;AASO,MAAM,iBAAiB;AAAA,EAC1B,kBAAkB;AAAA;AAAA,EAClB,oBAAoB;AAAA;AAAA,EACpB,yBAAyB;AAAA;AAAA,EACzB,sBAAsB;AAAA;AAC1B;AASO,MAAM,kBAAkB,aAAE,OAAO;AAAA,EACpC,UAAU,aAAE,KAAK,CAAC,UAAU,YAAY,CAAC;AAAA,EACzC,OAAO,aAAE,OAAO,EAAE,IAAI,CAAC;AAAA,EACvB,OAAO,aAAE,OAAO,EACX,IAAI,GAAG,uBAAuB,EAC9B,IAAI,eAAe,kBAAkB,yBAAyB,eAAe,gBAAgB,aAAa;AAAA,EAC/G,SAAS,aAAE,OAAO;AAAA,IACd,aAAa,aAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,SAAS;AAAA,IAC/C,WAAW,aAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS;AAAA,EACpD,CAAC,EAAE,SAAS;AAChB,CAAC;AAmEM,MAAM,wBAAwB,MAAM;AAAA,EACvC,YACI,SACO,UACA,aAAqB,KAC9B;AACE,UAAM,OAAO;AAHN;AACA;AAGP,SAAK,OAAO;AAAA,EAChB;AACJ;AAEO,MAAM,iCAAiC,MAAM;AAAA,EAChD,YACW,UACA,WACT;AACE,UAAM,sCAAsC,QAAQ,gBAAgB,SAAS,EAAE;AAHxE;AACA;AAGP,SAAK,OAAO;AAAA,EAChB;AACJ;AAEO,MAAM,0BAA0B,MAAM;AAAA,EACzC,YAAY,SAAiB;AACzB,UAAM,OAAO;AACb,SAAK,OAAO;AAAA,EAChB;AACJ;",
  "names": []
}
