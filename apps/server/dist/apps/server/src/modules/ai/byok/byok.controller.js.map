{
  "version": 3,
  "sources": ["../../../../../../../src/modules/ai/byok/byok.controller.ts"],
  "sourcesContent": ["import { Request, Response } from 'express';\r\nimport { ModelManagementService } from './model-management.service';\r\nimport { z } from 'zod';\r\nimport { errorHandler, successHandler } from '../../../common/middlewares/responseHandler';\r\nimport { parseError } from '../../../common/utils/error.parser';\r\n\r\nconst SetConfigSchema = z.object({\r\n    provider: z.string(),\r\n    model: z.string(),\r\n    apiKey: z.string().optional(),\r\n    isDefault: z.boolean().optional(),\r\n});\r\n\r\nexport class BYOKController {\r\n\r\n    /**\r\n     * Get all supported models\r\n     */\r\n    static async getSupportedModels(req: Request, res: Response) {\r\n        try {\r\n            const models = await ModelManagementService.getSupportedModels();\r\n            return successHandler(res, 'Supported models fetched successfully', models, 200);\r\n        } catch (error) {\r\n            console.error('Error fetching supported models:', error);\r\n            const errorParser = parseError(error);\r\n            return errorHandler(res, 'Failed to fetch supported models', errorParser.message, errorParser.statusCode);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get user's model configurations\r\n     */\r\n    static async getUserConfigs(req: Request, res: Response) {\r\n        try {\r\n            // @ts-ignore\r\n            const userId = req.user.userId;\r\n            const configs = await ModelManagementService.getUserConfigs(userId);\r\n            return successHandler(res, 'User configurations fetched successfully', configs, 200);\r\n        } catch (error) {\r\n            console.error('Error fetching user configs:', error);\r\n            const errorParser = parseError(error);\r\n            return errorHandler(res, 'Failed to fetch user configurations', errorParser.message, errorParser.statusCode);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set or update a user model configuration\r\n     */\r\n    static async setUserConfig(req: Request, res: Response) {\r\n        try {\r\n            // @ts-ignore\r\n            const userId = req.user.userId;\r\n            const validated = SetConfigSchema.parse(req.body);\r\n\r\n            const config = await ModelManagementService.setUserConfig(userId, validated);\r\n\r\n            return successHandler(res, 'Configuration saved successfully', config, 200);\r\n        } catch (error) {\r\n            console.error('Error setting user config:', error);\r\n            const errorParser = parseError(error);\r\n            return errorHandler(res, 'Failed to save configuration', errorParser.message, errorParser.statusCode);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Delete a user model configuration\r\n     */\r\n    static async deleteUserConfig(req: Request, res: Response) {\r\n        try {\r\n            // @ts-ignore\r\n            const userId = req.user.userId;\r\n            const { provider, model } = req.body;\r\n\r\n            if (!provider || !model) {\r\n                return errorHandler(res, 'Provider and model are required', {}, 400);\r\n            }\r\n\r\n            await ModelManagementService.deleteUserConfig(userId, provider, model);\r\n\r\n            return successHandler(res, 'Configuration deleted successfully', { provider, model }, 200);\r\n        } catch (error) {\r\n            console.error('Error deleting user config:', error);\r\n            const errorParser = parseError(error);\r\n            return errorHandler(res, 'Failed to delete configuration', errorParser.message, errorParser.statusCode);\r\n        }\r\n    }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,8BAAuC;AACvC,iBAAkB;AAClB,6BAA6C;AAC7C,mBAA2B;AAE3B,MAAM,kBAAkB,aAAE,OAAO;AAAA,EAC7B,UAAU,aAAE,OAAO;AAAA,EACnB,OAAO,aAAE,OAAO;AAAA,EAChB,QAAQ,aAAE,OAAO,EAAE,SAAS;AAAA,EAC5B,WAAW,aAAE,QAAQ,EAAE,SAAS;AACpC,CAAC;AAEM,MAAM,eAAe;AAAA;AAAA;AAAA;AAAA,EAKxB,aAAa,mBAAmB,KAAc,KAAe;AACzD,QAAI;AACA,YAAM,SAAS,MAAM,+CAAuB,mBAAmB;AAC/D,iBAAO,uCAAe,KAAK,yCAAyC,QAAQ,GAAG;AAAA,IACnF,SAAS,OAAO;AACZ,cAAQ,MAAM,oCAAoC,KAAK;AACvD,YAAM,kBAAc,yBAAW,KAAK;AACpC,iBAAO,qCAAa,KAAK,oCAAoC,YAAY,SAAS,YAAY,UAAU;AAAA,IAC5G;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,eAAe,KAAc,KAAe;AACrD,QAAI;AAEA,YAAM,SAAS,IAAI,KAAK;AACxB,YAAM,UAAU,MAAM,+CAAuB,eAAe,MAAM;AAClE,iBAAO,uCAAe,KAAK,4CAA4C,SAAS,GAAG;AAAA,IACvF,SAAS,OAAO;AACZ,cAAQ,MAAM,gCAAgC,KAAK;AACnD,YAAM,kBAAc,yBAAW,KAAK;AACpC,iBAAO,qCAAa,KAAK,uCAAuC,YAAY,SAAS,YAAY,UAAU;AAAA,IAC/G;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,cAAc,KAAc,KAAe;AACpD,QAAI;AAEA,YAAM,SAAS,IAAI,KAAK;AACxB,YAAM,YAAY,gBAAgB,MAAM,IAAI,IAAI;AAEhD,YAAM,SAAS,MAAM,+CAAuB,cAAc,QAAQ,SAAS;AAE3E,iBAAO,uCAAe,KAAK,oCAAoC,QAAQ,GAAG;AAAA,IAC9E,SAAS,OAAO;AACZ,cAAQ,MAAM,8BAA8B,KAAK;AACjD,YAAM,kBAAc,yBAAW,KAAK;AACpC,iBAAO,qCAAa,KAAK,gCAAgC,YAAY,SAAS,YAAY,UAAU;AAAA,IACxG;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,iBAAiB,KAAc,KAAe;AACvD,QAAI;AAEA,YAAM,SAAS,IAAI,KAAK;AACxB,YAAM,EAAE,UAAU,MAAM,IAAI,IAAI;AAEhC,UAAI,CAAC,YAAY,CAAC,OAAO;AACrB,mBAAO,qCAAa,KAAK,mCAAmC,CAAC,GAAG,GAAG;AAAA,MACvE;AAEA,YAAM,+CAAuB,iBAAiB,QAAQ,UAAU,KAAK;AAErE,iBAAO,uCAAe,KAAK,sCAAsC,EAAE,UAAU,MAAM,GAAG,GAAG;AAAA,IAC7F,SAAS,OAAO;AACZ,cAAQ,MAAM,+BAA+B,KAAK;AAClD,YAAM,kBAAc,yBAAW,KAAK;AACpC,iBAAO,qCAAa,KAAK,kCAAkC,YAAY,SAAS,YAAY,UAAU;AAAA,IAC1G;AAAA,EACJ;AACJ;",
  "names": []
}
