{
  "version": 3,
  "sources": ["../../../../../../../src/modules/ai/byok/encryption.service.ts"],
  "sourcesContent": ["import * as crypto from 'crypto';\r\n\r\nconst ALGORITHM = 'aes-256-cbc';\r\n// Use provided key or fallback for dev/demo (Not production safe without env var)\r\nconst ENCRYPTION_KEY = process.env.ENCRYPTION_KEY || '12345678901234567890123456789012';\r\nconst IV_LENGTH = 16;\r\n\r\nexport class EncryptionService {\r\n    static encrypt(text: string): string {\r\n        // Ensure key is 32 bytes\r\n        const key = Buffer.from(ENCRYPTION_KEY.padEnd(32, '0').slice(0, 32));\r\n        const iv = crypto.randomBytes(IV_LENGTH);\r\n        const cipher = crypto.createCipheriv(ALGORITHM, key, iv);\r\n        let encrypted = cipher.update(text);\r\n        encrypted = Buffer.concat([encrypted, cipher.final()]);\r\n        return iv.toString('hex') + ':' + encrypted.toString('hex');\r\n    }\r\n\r\n    static decrypt(text: string): string {\r\n        const key = Buffer.from(ENCRYPTION_KEY.padEnd(32, '0').slice(0, 32));\r\n        const textParts = text.split(':');\r\n        const iv = Buffer.from(textParts.shift()!, 'hex');\r\n        const encryptedText = Buffer.from(textParts.join(':'), 'hex');\r\n        const decipher = crypto.createDecipheriv(ALGORITHM, key, iv);\r\n        let decrypted = decipher.update(encryptedText);\r\n        decrypted = Buffer.concat([decrypted, decipher.final()]);\r\n        return decrypted.toString();\r\n    }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAwB;AAExB,MAAM,YAAY;AAElB,MAAM,iBAAiB,QAAQ,IAAI,kBAAkB;AACrD,MAAM,YAAY;AAEX,MAAM,kBAAkB;AAAA,EAC3B,OAAO,QAAQ,MAAsB;AAEjC,UAAM,MAAM,OAAO,KAAK,eAAe,OAAO,IAAI,GAAG,EAAE,MAAM,GAAG,EAAE,CAAC;AACnE,UAAM,KAAK,OAAO,YAAY,SAAS;AACvC,UAAM,SAAS,OAAO,eAAe,WAAW,KAAK,EAAE;AACvD,QAAI,YAAY,OAAO,OAAO,IAAI;AAClC,gBAAY,OAAO,OAAO,CAAC,WAAW,OAAO,MAAM,CAAC,CAAC;AACrD,WAAO,GAAG,SAAS,KAAK,IAAI,MAAM,UAAU,SAAS,KAAK;AAAA,EAC9D;AAAA,EAEA,OAAO,QAAQ,MAAsB;AACjC,UAAM,MAAM,OAAO,KAAK,eAAe,OAAO,IAAI,GAAG,EAAE,MAAM,GAAG,EAAE,CAAC;AACnE,UAAM,YAAY,KAAK,MAAM,GAAG;AAChC,UAAM,KAAK,OAAO,KAAK,UAAU,MAAM,GAAI,KAAK;AAChD,UAAM,gBAAgB,OAAO,KAAK,UAAU,KAAK,GAAG,GAAG,KAAK;AAC5D,UAAM,WAAW,OAAO,iBAAiB,WAAW,KAAK,EAAE;AAC3D,QAAI,YAAY,SAAS,OAAO,aAAa;AAC7C,gBAAY,OAAO,OAAO,CAAC,WAAW,SAAS,MAAM,CAAC,CAAC;AACvD,WAAO,UAAU,SAAS;AAAA,EAC9B;AACJ;",
  "names": []
}
