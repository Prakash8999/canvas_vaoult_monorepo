{
  "version": 3,
  "sources": ["../../../../../../src/modules/notes/notes.model.ts"],
  "sourcesContent": ["import { DataTypes, Model } from 'sequelize';\r\nimport sequelize from '../../config/database';\r\nimport { z } from 'zod';\r\nimport { extendZodWithOpenApi } from '@asteasolutions/zod-to-openapi';\r\nimport WikiLink from './wikilink.model';\r\n\r\nextendZodWithOpenApi(z);\r\n\r\nexport const NoteSchema = z\r\n\t.object({\r\n\t\tid: z.number().int().openapi({\r\n\t\t\texample: 1,\r\n\t\t\tdescription: 'Unique identifier for the note',\r\n\t\t}),\r\n\r\n\t\tnote_uid: z.string().openapi({\r\n\t\t\texample: 'note-12345',\r\n\t\t\tdescription: 'Unique UID for the note, used for client-side identification',\r\n\t\t}),\r\n\t\tuser_id: z.number().int().openapi({\r\n\t\t\texample: 1,\r\n\t\t\tdescription: 'ID of the user who owns the note',\r\n\t\t}),\r\n\t\tis_wiki_link: z.boolean().optional().default(false).openapi({\r\n\t\t\texample: false,\r\n\t\t\tdescription: 'Indicates if the note is a wiki link',\r\n\t\t}),\r\n\t\tparent_note_id: z.number().int().nullable().optional().openapi({\r\n\t\t\texample: null,\r\n\t\t\tdescription: 'Optional parent note ID for hierarchical organization for wiki links notes',\r\n\t\t}),\r\n\r\n\t\tchild_note_id: z.number().int().nullable().optional().openapi({\r\n\t\t\texample: null,\r\n\t\t\tdescription: 'Optional child note ID for hierarchical organization for wiki links notes',\r\n\t\t}),\r\n\r\n\r\n\t\ttitle: z.string().min(1).openapi({\r\n\t\t\texample: 'Weekly Summary',\r\n\t\t\tdescription: 'Title of the note',\r\n\t\t}),\r\n\r\n\t\tcontent: z\r\n\t\t\t.record(z.string(), z.any()).optional()\r\n\t\t\t.openapi({\r\n\t\t\t\tdescription: 'EditorJS JSON blocks (rich text content)'\r\n\t\t\t}),\r\n\r\n\t\ttags: z.array(z.string()).optional().openapi({\r\n\t\t\texample: ['weekly', 'report', 'internal'],\r\n\t\t\tdescription: 'Optional tags for filtering and grouping notes',\r\n\t\t}),\r\n\r\n\t\tversion: z.number().int().default(1).openapi({\r\n\t\t\texample: 1,\r\n\t\t\tdescription: 'Version number of the note',\r\n\t\t}),\r\n\r\n\t\tpinned: z.boolean().default(false).openapi({\r\n\t\t\texample: false,\r\n\t\t\tdescription: 'Whether the note is pinned for quick access',\r\n\t\t}),\r\n\t\tattachment_ids: z.array(z.number().int()).optional().openapi({\r\n\t\t\texample: [1, 2, 3],\r\n\t\t\tdescription: 'Array of attachment IDs linked to this note',\r\n\t\t}),\r\n\t\tnote_type: z.enum(['note', 'canvas', 'quick_capture']).default('note').openapi({\r\n\t\t\texample: 'note',\r\n\t\t\tdescription: 'Type of the note',\r\n\t\t}),\r\n\r\n\t\tcreated_at: z.date().optional().openapi({\r\n\t\t\ttype: 'string',\r\n\t\t\tformat: 'date-time',\r\n\t\t\texample: '2025-10-08T09:00:00Z',\r\n\t\t\tdescription: 'Timestamp when the note was created',\r\n\t\t}),\r\n\r\n\t\tupdated_at: z.date().optional().openapi({\r\n\t\t\ttype: 'string',\r\n\t\t\tformat: 'date-time',\r\n\t\t\texample: '2025-10-08T09:00:00Z',\r\n\t\t\tdescription: 'Timestamp when the note was last updated',\r\n\t\t}),\r\n\t})\r\n\t.openapi({\r\n\t\ttitle: 'Note',\r\n\t\tdescription: 'Represents a note entity storing content in JSON format',\r\n\t});\r\n\r\n// --------------------\r\n// \uD83E\uDDE9 Derived Schemas\r\n// --------------------\r\nexport const CreateNoteSchema = NoteSchema.omit({\r\n\tid: true,\r\n\tcreated_at: true,\r\n\tupdated_at: true,\r\n\tuser_id: true,\r\n\tnote_uid: true,\r\n\tchild_note_id: true,\r\n}).openapi({\r\n\ttitle: 'CreateNoteInput',\r\n\tdescription: 'Payload for creating a new note',\r\n});\r\n\r\nexport const UpdateNoteSchema = NoteSchema.partial().omit({\r\n\tid: true,\r\n\tuser_id: true,\r\n\tupdated_at: true,\r\n\tnote_uid: true,\r\n\tcreated_at: true,\r\n}).openapi({\r\n\ttitle: 'UpdateNoteInput',\r\n\tdescription: 'Payload for updating an existing note',\r\n});\r\nexport interface TagNoteRef {\r\n\tnote_name: string;\r\n\tcreated_at: Date;\r\n\tupdated_at: Date;\r\n\tnote_uid: string;\r\n\tnote_id: number;\r\n}\r\n\r\nexport interface AllTagEntry {\r\n\ttag: string;\r\n\tnotes: TagNoteRef[];\r\n}\r\n\r\nexport interface ExtractedNote {\r\n\tid: number;\r\n\ttitle: string;\r\n\tcreated_at: Date;\r\n\tupdated_at: Date;\r\n\tnote_uid: string;\r\n\ttags: string[];\r\n}\r\n\r\n// --------------------\r\n// \uD83E\uDDE9 Types\r\n// --------------------\r\nexport type NoteAttributes = z.infer<typeof NoteSchema>;\r\nexport type NoteCreationAttributes = z.infer<typeof CreateNoteSchema>;\r\nexport type NoteUpdateAttributes = z.infer<typeof UpdateNoteSchema>;\r\n\r\nexport const GetNotesQuerySchema = z.object({\r\n\tid: z.coerce.number().int().positive().optional().openapi({\r\n\t\texample: 1,\r\n\t\tdescription: 'Filter by note ID',\r\n\t}),\r\n\tnote_uid: z.string().optional().openapi({\r\n\t\texample: 'note-123',\r\n\t\tdescription: 'Filter by note UID',\r\n\t}),\r\n\ttitle: z.string().optional().openapi({\r\n\t\texample: 'My Note',\r\n\t\tdescription: 'Filter by title',\r\n\t}),\r\n\tpinned: z.enum(['true', 'false']).transform(val => val === 'true').optional().openapi({\r\n\t\texample: 'true',\r\n\t\tdescription: 'Filter by pinned status',\r\n\t}),\r\n\tsearch: z.string().optional().openapi({\r\n\t\texample: 'meeting',\r\n\t\tdescription: 'Search across title (partial match)',\r\n\t}),\r\n\tpage: z.coerce.number().int().positive().default(1).optional().openapi({\r\n\t\texample: 1,\r\n\t\tdescription: 'Page number',\r\n\t}),\r\n\tlimit: z.coerce.number().int().positive().max(100).default(10).optional().openapi({\r\n\t\texample: 10,\r\n\t\tdescription: 'Items per page',\r\n\t}),\r\n\tsort: z.enum(['asc', 'desc']).default('desc').optional().openapi({\r\n\t\texample: 'desc',\r\n\t\tdescription: 'Sort order',\r\n\t}),\r\n\tsort_by: z.enum(['created_at', 'updated_at']).default('updated_at').optional().openapi({\r\n\t\texample: 'updated_at',\r\n\t\tdescription: 'Field to sort by',\r\n\t}),\r\n\tcreated_at: z.date().optional(),\r\n\tupdated_at: z.date().optional(),\r\n}).openapi({\r\n\ttitle: 'GetNotesQueryParams',\r\n\tdescription: 'Query parameters for filtering and paginating notes',\r\n});\r\n\r\nexport const NoteIdParamsSchema = z.object({\r\n\tid: z.string().regex(/^\\d+$/, 'ID must be a positive integer').openapi({\r\n\t\texample: '1',\r\n\t\tdescription: 'Canvas ID (numeric string)',\r\n\t}),\r\n});\r\n\r\nexport type NoteQueryAttributes = z.infer<typeof GetNotesQuerySchema>;\r\n\r\n// --------------------\r\n// \uD83E\uDDE9 Sequelize Model\r\n// --------------------\r\nexport class Note\r\n\textends Model<NoteAttributes, NoteCreationAttributes>\r\n\timplements NoteAttributes {\r\n\tpublic id!: number;\r\n\tpublic note_uid!: string;\r\n\tpublic user_id!: number;\r\n\tpublic title!: string;\r\n\tpublic content!: Record<string, any>;\r\n\tpublic attachment_ids?: number[];\r\n\tpublic tags?: string[];\r\n\tpublic parent_note_id?: number | null;\r\n\tpublic is_wiki_link!: boolean;\r\n\tpublic version!: number;\r\n\tpublic pinned!: boolean;\r\n\tpublic note_type!: 'note' | 'canvas' | 'quick_capture';\r\n\tpublic created_at!: Date;\r\n\tpublic updated_at!: Date;\r\n\tdeclare public child_wikilinks?: WikiLink[];\r\n\tdeclare public parent_wikilinks?: WikiLink[];\r\n}\r\n\r\nNote.init(\r\n\t{\r\n\t\tid: {\r\n\t\t\ttype: DataTypes.INTEGER,\r\n\t\t\tautoIncrement: true,\r\n\t\t\tprimaryKey: true,\r\n\t\t\tallowNull: false,\r\n\t\t},\r\n\t\tnote_type: {\r\n\t\t\ttype: DataTypes.ENUM('note', 'canvas', 'quick_capture'),\r\n\t\t\tallowNull: false,\r\n\t\t\tdefaultValue: 'note',\r\n\t\t},\r\n\t\tnote_uid: {\r\n\t\t\ttype: DataTypes.STRING,\r\n\t\t\tallowNull: false,\r\n\t\t},\r\n\t\tuser_id: {\r\n\t\t\ttype: DataTypes.INTEGER,\r\n\t\t\tallowNull: false,\r\n\t\t},\r\n\t\ttitle: {\r\n\t\t\ttype: DataTypes.TEXT,\r\n\t\t\tallowNull: false,\r\n\t\t},\r\n\r\n\t\tparent_note_id: {\r\n\t\t\ttype: DataTypes.INTEGER,\r\n\t\t\tallowNull: true,\r\n\t\t\tcomment: 'Optional parent note ID for hierarchical organization for wiki links notes',\r\n\t\t},\r\n\t\tis_wiki_link: {\r\n\t\t\ttype: DataTypes.BOOLEAN,\r\n\t\t\tallowNull: false,\r\n\t\t\tdefaultValue: false\r\n\t\t},\r\n\t\tcontent: {\r\n\t\t\ttype: DataTypes.JSON,\r\n\t\t\tallowNull: true,\r\n\t\t\tcomment: 'EditorJS content blocks as JSON',\r\n\t\t},\r\n\t\ttags: {\r\n\t\t\ttype: DataTypes.JSON,\r\n\t\t\tallowNull: true,\r\n\t\t\tcomment: 'Array of tags (string[])'\r\n\t\t},\r\n\t\tversion: {\r\n\t\t\ttype: DataTypes.INTEGER,\r\n\t\t\tallowNull: false,\r\n\t\t\tdefaultValue: 1,\r\n\t\t},\r\n\t\tattachment_ids: {\r\n\t\t\ttype: DataTypes.JSON,\r\n\t\t\tallowNull: true,\r\n\t\t\tcomment: 'Array of attachment IDs (number[])'\r\n\t\t},\r\n\t\tpinned: {\r\n\t\t\ttype: DataTypes.BOOLEAN,\r\n\t\t\tallowNull: false,\r\n\t\t\tdefaultValue: false,\r\n\t\t},\r\n\t\tcreated_at: {\r\n\t\t\ttype: DataTypes.DATE,\r\n\t\t\tallowNull: false,\r\n\t\t},\r\n\t\tupdated_at: {\r\n\t\t\ttype: DataTypes.DATE,\r\n\t\t\tallowNull: true,\r\n\t\t},\r\n\t},\r\n\t{\r\n\t\tsequelize,\r\n\t\ttableName: 'notes',\r\n\t\ttimestamps: false,\r\n\t\tindexes: [\r\n\t\t\t{\r\n\t\t\t\tfields: ['note_uid'],\r\n\t\t\t\tunique: true,\r\n\t\t\t}\r\n\t\t],\r\n\t}\r\n);\r\n\r\nexport default Note;\r\n"],
  "mappings": "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",
  "names": ["sequelize"]
}
